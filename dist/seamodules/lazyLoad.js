define(function(require,exports,module){return{map_element:{},element_obj:[],download_count:0,last_offset:-1,doc_body:"",doc_element:"",lazyLoad_tag:"",initVar:function(tags){var me=this;me.doc_body=document.body,me.doc_element="BackCompat"==document.compatMode?me.doc_body:document.documentElement,me.lazyLoad_tag=tags||["img"]},initElementMap:function(){for(var me=this,i=0,len=me.lazyLoad_tag.length;len>i;i++)for(var el=document.getElementsByTagName(me.lazyLoad_tag[i]),j=0,len2=el.length;len2>j;j++)"object"==typeof el[j]&&el[j].getAttribute("lazy_src")&&me.element_obj.push(el[j]);for(var i=0,len=me.element_obj.length;len>i;i++){var o_img=me.element_obj[i],t_index=me.getAbsoluteTop(o_img);if(me.map_element[t_index])me.map_element[t_index].push(i);else{var t_array=[];t_array[0]=i,me.map_element[t_index]=t_array,me.download_count++}}},initDownloadListen:function(scope){var me=this;if(scope&&(me=scope),me.download_count){var offset=me.getNagavVersion().isWebkit?me.doc_body.scrollTop:me.doc_element.scrollTop,visio_offset=offset+me.doc_element.clientHeight;if(me.last_offset==visio_offset)return void setTimeout(function(){me.initDownloadListen(me)},200);me.last_offset=visio_offset;var visio_height=me.doc_element.clientHeight,img_show_height=visio_height+offset;for(var key in me.map_element)if(img_show_height>key){for(var t_o=me.map_element[key],img_vl=t_o.length,l=0;img_vl>l;l++){var nowEl=me.element_obj[t_o[l]],lazySrc=nowEl.getAttribute("lazy_src");if(console.log(nowEl.getAttribute("lazy_src")),"VIDIO"==nowEl.tagName.toUpperCase()){var tempEl=nowEl;require.async("modules/swfobject",function(sobj){var dd=sobj.swfobject(),el=document.getElementById(tempEl.getAttribute("attr-control"));dd.embedSWF(tempEl.getAttribute("lazy_src"),el,"100%",480,10)})}else nowEl.src=lazySrc}delete me.map_element[key],me.download_count--}setTimeout(function(){me.initDownloadListen(me)},200)}},getAbsoluteTop:function(element){if(!element)return null;for(var mendingOb=element,mendingTop=mendingOb.offsetTop;null!=mendingOb&&null!=mendingOb.offsetParent&&"BODY"!=mendingOb.offsetParent.tagName;)mendingTop+=mendingOb.offsetParent.offsetTop,mendingOb=mendingOb.offsetParent;return mendingTop},getNagavVersion:function(){var s,Sys={},ua=navigator.userAgent.toLowerCase();return(s=ua.match(/msie ([\d.]+)/))?Sys.isIE=s[1]:(s=ua.match(/firefox\/([\d.]+)/))?Sys.isGecko=s[1]:(s=ua.match(/chrome\/([\d.]+)/))?Sys.isWebkit=s[1]:(s=ua.match(/opera.([\d.]+)/))?Sys.IsOpera=s[1]:(s=ua.match(/version\/([\d.]+).*safari/))?Sys.isSafari=s[1]:0,Sys},randFun:"",init:function(tags,randFun){var me=this;me.randFun=randFun,me.initVar(tags),me.initElementMap(),me.initDownloadListen()}}});