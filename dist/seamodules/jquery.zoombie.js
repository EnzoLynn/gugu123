define(function(require,exports,module){return function($){!function($){$.fn.zoombieLens=function(options){var me=this,defaults={Size:100,borderSize:4,borderColor:"#888"},options=$.extend(defaults,options),lensType="background-position: 0px 0px;width: "+String(options.Size)+"px;height: "+String(options.Size)+"px;float: left;display: none;border: "+String(options.borderSize)+"px solid "+options.borderColor+";background-repeat: no-repeat;position: absolute;z-index:111;";return this.each(function(){function setImage(e){offset=obj.offset();var leftPos=parseInt(e.pageX-offset.left),topPos=parseInt(e.pageY-offset.top);0>leftPos||0>topPos||leftPos>obj.width()||topPos>obj.height()?target.hide():(click&&target.show(),leftPos=String(-1*((e.pageX-offset.left)*widthRatio-target.width()/2)),topPos=String(-1*((e.pageY-offset.top)*heightRatio-target.height()/2)),target.css({backgroundPosition:leftPos+"px "+topPos+"px"}),leftPos=String(e.pageX-target.width()/2),topPos=String(e.pageY-target.height()/2),target.css({left:leftPos+"px",top:topPos+"px"}))}obj=$(this);var imageSrc,imageTag,widthRatio,heightRatio,offset=obj.offset(),target=$("<div style='"+lensType+"' class='"+options.lensCss+"'>&nbsp;</div>").appendTo($("body")),click=(target.size(),!1),fistInit=!0;target.click(function(e){click&&(target.unbind("mousemove",setImage),$(this).unbind("mousemove",setImage),click=!1,target.hide())}),$(this).click(function(e){if(click);else{fistInit&&(imageSrc=options.imageSrc?options.imageSrc:$(this).attr("bsrc"),imageTag="<img class='imgPic' style='display:none;' src='"+imageSrc+"' />",widthRatio=0,heightRatio=0,$(imageTag).load(function(){widthRatio=$(this).width()/obj.width(),heightRatio=$(this).height()/obj.height(),setTimeout(function(){setImage(e)},10)}).appendTo($(me).parent()),target.css({backgroundImage:"url('"+imageSrc+"')"}),fistInit=!1),target.mousemove(setImage),$(this).mousemove(setImage),click=!0;var leftPos=parseInt(e.pageX-offset.left),topPos=parseInt(e.pageY-offset.top);leftPos=String(-1*((e.pageX-offset.left)*widthRatio-target.width()/2)),topPos=String(-1*((e.pageY-offset.top)*heightRatio-target.height()/2)),target.css({backgroundPosition:leftPos+"px "+topPos+"px"}),leftPos=String(e.pageX-target.width()/2),topPos=String(e.pageY-target.height()/2),target.css({left:leftPos+"px",top:topPos+"px"}),target.show()}})})}}(jQuery),function($){var defaults={url:!1,callback:!1,target:!1,duration:120,on:"mouseover"};$.zoombie=function(target,source,img){var outerWidth,outerHeight,xRatio,yRatio,offset,position=$(target).css("position");return $(target).css({position:/(absolute|fixed)/.test()?position:"relative",overflow:"hidden"}),$(img).addClass("zoomImg").css({position:"absolute",top:0,left:0,opacity:0,width:img.width,height:img.height,border:"none",maxWidth:"none"}).appendTo(target),{init:function(){outerWidth=$(target).outerWidth(),outerHeight=$(target).outerHeight(),xRatio=(img.width-outerWidth)/$(source).outerWidth(),yRatio=(img.height-outerHeight)/$(source).outerHeight(),offset=$(source).offset()},move:function(e){var left=e.pageX-offset.left,top=e.pageY-offset.top;top=Math.max(Math.min(top,outerHeight),0),left=Math.max(Math.min(left,outerWidth),0),img.style.left=left*-xRatio+"px",img.style.top=top*-yRatio+"px"}}},$.fn.zoombie=function(options){return this.each(function(){var settings=$.extend({},defaults,options||{}),target=settings.target||this,source=this,img=new Image,$img=$(img),mousemove="mousemove",clicked=!1;(settings.url||(settings.url=$(source).find("img").attr("src"),settings.url))&&(img.onload=function(){function start(e){zoombie.init(),zoombie.move(e),$img.stop().fadeTo($.support.opacity?settings.duration:0,1)}function stop(){$img.stop().fadeTo(settings.duration,0)}var zoombie=$.zoombie(target,source,img);"grab"===settings.on?$(source).mousedown(function(e){$(document).one("mouseup",function(){stop(),$(document).unbind(mousemove,zoombie.move)}),start(e),$(document)[mousemove](zoombie.move),e.preventDefault()}):"click"===settings.on?$(source).click(function(e){return clicked?void 0:(clicked=!0,start(e),$(document)[mousemove](zoombie.move),$(document).one("click",function(){stop(),clicked=!1,$(document).unbind(mousemove,zoombie.move)}),!1)}):"toggle"===settings.on?$(source).click(function(e){clicked?stop():start(e),clicked=!clicked}):(zoombie.init(),$(source).hover(start,stop)[mousemove](zoombie.move)),$.isFunction(settings.callback)&&settings.callback.call(img)},img.src=settings.url)})},$.fn.zoombie.defaults=defaults}(window.jQuery)}});
//# sourceMappingURL=jquery.zoombie.js.map